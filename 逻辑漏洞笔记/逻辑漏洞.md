# 逻辑漏洞（上）

漏洞即是逻辑缺陷，所有漏洞几乎都是人导致的。一旦某种规则形成了约束效力，漏洞也就随之形成了。漏洞存在的一个很重要的条件是规则的形成，有了规则的约束，才有绕过的可能性。



## 10.1 突破功能限制漏洞

有限制就有突破，限制和突破是相对的。



基于凭证类的，最直接的方法就是**伪造凭证**；基于物理限制的，突破方法必不可少**物理破坏**，比如直接砸开门锁。值得注意的是：**通过前端的限制都是可以突破的。**



### 10.1.1 前端校验

如`<input>`的属性可以设置为readonly；`<button>`的属性可以设置为disabled；这类在前端的限制可以轻松绕过。可以通过burpsuite的 Intercept Server Response功能来批量替换服务器返回给客户端的数据。



### 10.1.2 突破功能限制场景分析

利用一些语言的特性，将提交的参数类型更改为数组类型，如：

```php
couponeid=KeyA变成couponeid[0]=KeyA&couponeid[1]=KeyB
```

JSON格式为：`{"couponeid": ["KeyA","KeyB"]}`



当然，有时绕过限制并不一定非要绕过规定的限制，需要充分了解业务场景，在特定场景下通过一定的手段将网站原本设定为不允许的操作变为允许。理论上，**只要能够实现违背网站设计者初衷的操作**都可以被认定为突破功能限制。





## 10.2 用户信息泄露

保护用户个人敏感信息是网络安全的重中之重。



### 10.2.1 用户信息泄露概述

用户信息泄露漏洞一般属于逻辑漏洞范畴，泄露的信息通常为**手机号、姓名、邮箱、身份证号、收货地址、订单、用户名、密码、银行卡号等**。



### 10.2.2 用户信息泄露场景分析

例1：注册、登录、找回密码时，服务器回显差异造成泄露。page.350

有些网站在登录时，可能会提示“==用户名不存在==”，而有时会提示“==用户名或密码错误==”。也就是说，当提交用户名在系统中存在时，如果密码错误，此时网站返回“用户名或密码错误”。当用户名明不存在时，网站提示“用户名不存在”。通过这一差异，攻击者就可以通过字典遍历，获取系统中可能存在的用户名列表。

对思维进行发散，同样在注册用户时，输入的账号（手机号、邮箱）如果已存在，系统也会报告出“该用户名已注册“的提示，攻击者可以在这个接口批量获取系统中已注册的用户名、手机号、邮箱列表的信息。



## 10.3 权限漏洞

权限即为限制，跨越权限本身也是突破限制。



### 10.3.1 越权漏洞概述

**越权漏洞**是指攻击者跨越网站应用原本的权限管理设计，获取甚至控制其他用户或管理员数据的一类漏洞，分为水平和垂直。

水平：跨越到平行的用户的权限；

垂直：跨越自身所属用户组，获取更高级别的用户甚至是管理员的权限。

案例：p359



## 10.4 遍历漏洞

不敏感的信息如果形成规模，也就变得敏感了。遍历漏洞就是一种由量变到质变的特殊漏洞类型。



场景分析：p360



## 10.5 弱口令

漏洞，归根基地是人为造成的问题。



### 10.5.1 弱口令概述

弱口令漏洞反映了用户及运维人员图省事的人形弱点问题。



### 10.5.2 暴力破解

攻击者破解口令最常用的方法是暴力破解，所谓的暴力破解，就是不断去尝试，知道成功为止。



### 10.5.3 固定密码攻击

对抗最大错误次数阈值，可以使用固定密码攻击。使用一个固定的密码（123456）去遍历所有的用户名，这样一个个尝试，便能找出密码为123456的用户名。



### 10.5.4 撞库攻击

撞库攻击是攻击者通过某些渠道获取的泄露的用户密码在目标网站上进行尝试，由于有相当一部分用户在多个网站使用同一个密码，所以撞库攻击的效率很高。





# 逻辑漏洞（下）

## 11.1 支付安全（上）

与支付相关的漏洞统称为**支付漏洞**，支付安全方面的漏洞很多，包括**溢出、精度问题、负数问题、修改支付相关参数、支付接口问题、条件竞争、重放攻击**等，其中条件竞争、重放攻击问题还经常出现在许多安全场景中。



